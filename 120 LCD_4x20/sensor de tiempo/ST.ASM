
; PICBASIC PRO(TM) Compiler 2.50a, (c) 1998, 2007 microEngineering Labs, Inc. All Rights Reserved.  
_USED			EQU	1

	INCLUDE	"C:\PBP\16F877A.INC"


; Define statements.
; C:\PBP\16F877A.BAS       	00018	DEFINE  CODE_SIZE 8
#define		CODE_SIZE		 8
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00011	DEFINE OSC 4
#define		OSC		 4
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00012	define LCD_DREG PORTC
#define		LCD_DREG		 PORTC
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00013	DEFINE LCD_DBIT 4
#define		LCD_DBIT		 4
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00014	define LCD_RSREG PORTC
#define		LCD_RSREG		 PORTC
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00015	DEFINE LCD_RSBIT 0
#define		LCD_RSBIT		 0
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00016	define LCD_EREG PORTC
#define		LCD_EREG		 PORTC
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00017	DEFINE LCD_EBIT 1
#define		LCD_EBIT		 1

RAM_START       		EQU	00020h
RAM_END         		EQU	001EFh
RAM_BANKS       		EQU	00004h
BANK0_START     		EQU	00020h
BANK0_END       		EQU	0007Fh
BANK1_START     		EQU	000A0h
BANK1_END       		EQU	000EFh
BANK2_START     		EQU	00110h
BANK2_END       		EQU	0016Fh
BANK3_START     		EQU	00190h
BANK3_END       		EQU	001EFh
EEPROM_START    		EQU	02100h
EEPROM_END      		EQU	021FFh

; C:\PBP\PBPPIC14.RAM      	00012	R0      VAR     WORD BANK0 SYSTEM       ' System Register
R0              		EQU	RAM_START + 000h
; C:\PBP\PBPPIC14.RAM      	00013	R1      VAR     WORD BANK0 SYSTEM       ' System Register
R1              		EQU	RAM_START + 002h
; C:\PBP\PBPPIC14.RAM      	00014	R2      VAR     WORD BANK0 SYSTEM       ' System Register
R2              		EQU	RAM_START + 004h
; C:\PBP\PBPPIC14.RAM      	00015	R3      VAR     WORD BANK0 SYSTEM       ' System Register
R3              		EQU	RAM_START + 006h
; C:\PBP\PBPPIC14.RAM      	00016	R4      VAR     WORD BANK0 SYSTEM       ' System Register
R4              		EQU	RAM_START + 008h
; C:\PBP\PBPPIC14.RAM      	00017	R5      VAR     WORD BANK0 SYSTEM       ' System Register
R5              		EQU	RAM_START + 00Ah
; C:\PBP\PBPPIC14.RAM      	00018	R6      VAR     WORD BANK0 SYSTEM       ' System Register
R6              		EQU	RAM_START + 00Ch
; C:\PBP\PBPPIC14.RAM      	00019	R7      VAR     WORD BANK0 SYSTEM       ' System Register
R7              		EQU	RAM_START + 00Eh
; C:\PBP\PBPPIC14.RAM      	00020	R8      VAR     WORD BANK0 SYSTEM       ' System Register
R8              		EQU	RAM_START + 010h
; C:\PBP\PBPPIC14.RAM      	00026	FLAGS   VAR     BYTE BANK0 SYSTEM       ' Static flags
FLAGS           		EQU	RAM_START + 012h
; C:\PBP\PBPPIC14.RAM      	00025	GOP     VAR     BYTE BANK0 SYSTEM       ' Gen Op Parameter
GOP             		EQU	RAM_START + 013h
; C:\PBP\PBPPIC14.RAM      	00022	RM1     VAR     BYTE BANK0 SYSTEM       ' Pin 1 Mask
RM1             		EQU	RAM_START + 014h
; C:\PBP\PBPPIC14.RAM      	00024	RM2     VAR     BYTE BANK0 SYSTEM       ' Pin 2 Mask
RM2             		EQU	RAM_START + 015h
; C:\PBP\PBPPIC14.RAM      	00021	RR1     VAR     BYTE BANK0 SYSTEM       ' Pin 1 Register
RR1             		EQU	RAM_START + 016h
; C:\PBP\PBPPIC14.RAM      	00023	RR2     VAR     BYTE BANK0 SYSTEM       ' Pin 2 Register
RR2             		EQU	RAM_START + 017h
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00001	'****************************************************************
T1              		EQU	RAM_START + 018h
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00001	'****************************************************************
T2              		EQU	RAM_START + 01Ah
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00001	'****************************************************************
T3              		EQU	RAM_START + 01Ch
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00023	CUENTA VAR BYTE
_CUENTA          		EQU	RAM_START + 01Eh
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00024	CUENTA2 VAR BYTE
_CUENTA2         		EQU	RAM_START + 01Fh
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00025	SEGUN VAR BYTE
_SEGUN           		EQU	RAM_START + 020h
; C:\PBP\16F877A.BAS       	00022	PORTL   VAR     PORTB
_PORTL           		EQU	 PORTB
; C:\PBP\16F877A.BAS       	00023	PORTH   VAR     PORTC
_PORTH           		EQU	 PORTC
; C:\PBP\16F877A.BAS       	00024	TRISL   VAR     TRISB
_TRISL           		EQU	 TRISB
; C:\PBP\16F877A.BAS       	00025	TRISH   VAR     TRISC
_TRISH           		EQU	 TRISC
#define _START           	_PORTD??2
#define _F1              	_PORTD??0
#define _F2              	_PORTD??1
#define _PORTD??2        	 PORTD, 002h
#define _PORTD??0        	 PORTD, 000h
#define _PORTD??1        	 PORTD, 001h
#define _INTCON??2       	 INTCON, 002h
	INCLUDE	"ST.MAC"
	INCLUDE	"C:\PBP\PBPPIC14.LIB"


; C:\PBP\16F877A.BAS       	00012	BANK0   $0020, $007F
; C:\PBP\16F877A.BAS       	00013	BANK1   $00A0, $00EF
; C:\PBP\16F877A.BAS       	00014	BANK2   $0110, $016F
; C:\PBP\16F877A.BAS       	00015	BANK3   $0190, $01EF
; C:\PBP\16F877A.BAS       	00016	EEPROM  $2100, $21FF
; C:\PBP\16F877A.BAS       	00017	LIBRARY "PBPPIC14"
; C:\PBP\16F877A.BAS       	00018	DEFINE  CODE_SIZE 8

; C:\PBP\16F877A.BAS       	00020	        include "PIC14EXT.BAS"

; C:\PBP\16F877A.BAS       	00027	        include "PBPPIC14.RAM"
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00011	DEFINE OSC 4
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00012	define LCD_DREG PORTC
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00013	DEFINE LCD_DBIT 4
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00014	define LCD_RSREG PORTC
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00015	DEFINE LCD_RSBIT 0
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00016	define LCD_EREG PORTC
; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00017	DEFINE LCD_EBIT 1

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00027	OPTION_REG = %1010110 ;setea TMR0 configurando y habilita PORTB pullups
	MOVE?CB	056h, OPTION_REG

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00028	INTCON = %10100000 ;hablilita TMR0 interrupción interna
	MOVE?CB	0A0h, INTCON

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00030	CUENTA=0
	MOVE?CB	000h, _CUENTA

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00032	INICIO:

	LABEL?L	_INICIO	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00033	IF F1=1 AND F1=1 AND START=1 THEN CONTAR ;botón para igualar minutos
	CMPEQ?TCB	_F1, 001h, T1
	CMPEQ?TCB	_F1, 001h, T2
	LAND?BBW	T1, T2, T2
	CMPEQ?TCB	_START, 001h, T3
	LAND?WBL	T2, T3, _CONTAR

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00034	SEGUN=0
	MOVE?CB	000h, _SEGUN

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00035	CUENTA2=0
	MOVE?CB	000h, _CUENTA2

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00036	LCDOUT $fe,1," ",dec2 SEGUN,".",dec2 CUENTA2
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	LCDOUT?C	020h
	LCDOUTCOUNT?C	002h
	LCDOUTNUM?B	_SEGUN
	LCDOUTDEC?	
	LCDOUT?C	02Eh
	LCDOUTCOUNT?C	002h
	LCDOUTNUM?B	_CUENTA2
	LCDOUTDEC?	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00037	PAUSE 20
	PAUSE?C	014h

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00038	GOTO INICIO
	GOTO?L	_INICIO

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00040	CONTAR:

	LABEL?L	_CONTAR	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00041	ON INTERRUPT GOTO interrup
	ONINT?LL	_interrup, L00001

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00043	LCDOUT $fe,1," ",dec2 SEGUN,".",dec2 CUENTA2
	ICALL?L	L00001
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	LCDOUT?C	020h
	LCDOUTCOUNT?C	002h
	LCDOUTNUM?B	_SEGUN
	LCDOUTDEC?	
	LCDOUT?C	02Eh
	LCDOUTCOUNT?C	002h
	LCDOUTNUM?B	_CUENTA2
	LCDOUTDEC?	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00045	IF F1=0 THEN PARARCONTEOF1
	ICALL?L	L00001
	CMPEQ?TCL	_F1, 000h, _PARARCONTEOF1

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00046	IF F2=0 THEN PARARCONTEOF2
	ICALL?L	L00001
	CMPEQ?TCL	_F2, 000h, _PARARCONTEOF2

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00047	GOTO CONTAR
	ICALL?L	L00001
	GOTO?L	_CONTAR

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00049	interrup:

	LABEL?L	_interrup	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00050	cuenta = cuenta + 1
	ICALL?L	L00001
	ADD?BCB	_CUENTA, 001h, _CUENTA

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00051	TMR0=4 ;resta 4 al contador de 256 del TMR0
	ICALL?L	L00001
	MOVE?CB	004h, TMR0

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00052	IF cuenta < 31 THEN reset ;31 cuentas (32256ms = 999936uS)
	ICALL?L	L00001
	CMPLT?BCL	_CUENTA, 01Fh, _reset

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00053	cuenta = 0
	ICALL?L	L00001
	MOVE?CB	000h, _CUENTA

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00054	segun = segun + 1
	ICALL?L	L00001
	ADD?BCB	_SEGUN, 001h, _SEGUN

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00055	CUENTA2 = CUENTA * 32256
	ICALL?L	L00001
	MUL?BCB	_CUENTA, 07E00h, _CUENTA2

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00057	reset:

	LABEL?L	_reset	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00058	INTCON.2 = 0 ;resetea la bandera de interrupción del TMR0
	ICALL?L	L00001
	MOVE?CT	000h, _INTCON??2

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00059	RESUME
	ICALL?L	L00001
	RESUME?	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00061	PARARCONTEOF1:

	LABEL?L	_PARARCONTEOF1	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00062	DISABLE
	DISABLE?	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00063	LCDOUT $fe,1," ",dec2 SEGUN,".",dec2 CUENTA2
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	LCDOUT?C	020h
	LCDOUTCOUNT?C	002h
	LCDOUTNUM?B	_SEGUN
	LCDOUTDEC?	
	LCDOUT?C	02Eh
	LCDOUTCOUNT?C	002h
	LCDOUTNUM?B	_CUENTA2
	LCDOUTDEC?	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00064	GOTO PARARCONTEOF1
	GOTO?L	_PARARCONTEOF1

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00066	PARARCONTEOF2:

	LABEL?L	_PARARCONTEOF2	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00067	LCDOUT $fe,1," ",dec2 SEGUN,".",dec2 CUENTA2
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	LCDOUT?C	020h
	LCDOUTCOUNT?C	002h
	LCDOUTNUM?B	_SEGUN
	LCDOUTDEC?	
	LCDOUT?C	02Eh
	LCDOUTCOUNT?C	002h
	LCDOUTNUM?B	_CUENTA2
	LCDOUTDEC?	

; C:\USERS\DAVID ARAUJO\DESKTOP\SENSOR DE TIEMPO\ST.PBP	00068	END
	END?	

	END
