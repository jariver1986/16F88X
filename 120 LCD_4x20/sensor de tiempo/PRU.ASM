
; PICBASIC PRO(TM) Compiler 2.50a, (c) 1998, 2007 microEngineering Labs, Inc. All Rights Reserved.  
_USED			EQU	1

	INCLUDE	"C:\PBP\16F871.INC"


; Define statements.
#define		CODE_SIZE		 2
#define		LCD_DREG		 PORTB
#define		LCD_DBIT		 4 
#define		LCD_RSREG		 PORTB
#define		LCD_RSBIT		 0 
#define		LCD_EREG		    PORTB
#define		LCD_EBIT		    1
#define		LCD_BIT		 4
#define		OSC		 4

RAM_START       		EQU	00020h
RAM_END         		EQU	000BFh
RAM_BANKS       		EQU	00002h
BANK0_START     		EQU	00020h
BANK0_END       		EQU	0007Fh
BANK1_START     		EQU	000A0h
BANK1_END       		EQU	000BFh
EEPROM_START    		EQU	02100h
EEPROM_END      		EQU	0213Fh

R0              		EQU	RAM_START + 000h
R1              		EQU	RAM_START + 002h
R2              		EQU	RAM_START + 004h
R3              		EQU	RAM_START + 006h
R4              		EQU	RAM_START + 008h
R5              		EQU	RAM_START + 00Ah
R6              		EQU	RAM_START + 00Ch
R7              		EQU	RAM_START + 00Eh
R8              		EQU	RAM_START + 010h
FLAGS           		EQU	RAM_START + 012h
GOP             		EQU	RAM_START + 013h
RM1             		EQU	RAM_START + 014h
RM2             		EQU	RAM_START + 015h
RR1             		EQU	RAM_START + 016h
RR2             		EQU	RAM_START + 017h
T1              		EQU	RAM_START + 018h
T2              		EQU	RAM_START + 01Ah
T3              		EQU	RAM_START + 01Ch
_tiempo          		EQU	RAM_START + 01Eh
_TIEMPO2         		EQU	RAM_START + 020h
_TIEMPO3         		EQU	RAM_START + 022h
_PORTL           		EQU	 PORTB
_PORTH           		EQU	 PORTC
_TRISL           		EQU	 TRISB
_TRISH           		EQU	 TRISC
#define _PANTALLA1       	_PORTC??0
#define _PANTALLA2       	_PORTC??1
#define _start           	_PORTD??0
#define _FUSIBLE1        	_PORTD??1
#define _FUSIBLE2        	_PORTD??2
#define _reset           	_PORTD??7
#define _PORTC??0        	 PORTC, 000h
#define _PORTC??1        	 PORTC, 001h
#define _PORTD??0        	 PORTD, 000h
#define _PORTD??1        	 PORTD, 001h
#define _PORTD??2        	 PORTD, 002h
#define _PORTD??7        	 PORTD, 007h
	INCLUDE	"PRU.MAC"
	INCLUDE	"C:\PBP\PBPPIC14.LIB"

	MOVE?CB	0FFh, TRISD

	LABEL?L	_inicio	
	MOVE?CW	000h, _TIEMPO3
	MOVE?CW	000h, _tiempo
	MOVE?CW	000h, _TIEMPO2
	HIGH?T	_PANTALLA1
	HIGH?T	_PANTALLA2
	PAUSE?C	0C8h
	LCDOUT?C	0FEh
	LCDOUT?C	001h
	LCDOUT?C	0FEh
	LCDOUT?C	080h
	LCDOUT?C	046h
	LCDOUT?C	041h
	LCDOUT?C	056h
	LCDOUT?C	04Fh
	LCDOUT?C	052h
	LCDOUT?C	020h
	LCDOUT?C	043h
	LCDOUT?C	045h
	LCDOUT?C	052h
	LCDOUT?C	052h
	LCDOUT?C	041h
	LCDOUT?C	052h
	LCDOUT?C	0FEh
	LCDOUT?C	0C0h
	LCDOUT?C	046h
	LCDOUT?C	031h
	LCDOUT?C	02Ch
	LCDOUT?C	020h
	LCDOUT?C	046h
	LCDOUT?C	032h
	LCDOUT?C	020h
	LCDOUT?C	0FEh
	LCDOUT?C	094h
	LCDOUT?C	059h
	LCDOUT?C	020h
	LCDOUT?C	050h
	LCDOUT?C	055h
	LCDOUT?C	04Ch
	LCDOUT?C	053h
	LCDOUT?C	041h
	LCDOUT?C	052h
	LCDOUT?C	020h
	LCDOUT?C	04Dh
	LCDOUT?C	041h
	LCDOUT?C	052h
	LCDOUT?C	043h
	LCDOUT?C	048h
	LCDOUT?C	041h
	CMPEQ?TCB	_start, 000h, T1
	CMPEQ?TCB	_FUSIBLE1, 000h, T2
	LAND?BBW	T1, T2, T2
	CMPEQ?TCB	_FUSIBLE2, 000h, T3
	LAND?WBL	T2, T3, _BORRADO
	GOTO?L	_inicio

	LABEL?L	_BORRADO	
	LCDOUT?C	0FEh
	LCDOUT?C	001h

	LABEL?L	_cronometro	
	CMPEQ?TCL	_start, 001h, _inicio
	MUL?WCW	_TIEMPO2, 003E8h, T1
	ADD?WWW	T1, _tiempo, _TIEMPO3
	CMPEQ?TCL	_FUSIBLE1, 001h, _mostrar1
	CMPEQ?TCL	_FUSIBLE2, 001h, _mostrar2
	LCDOUT?C	0FEh
	LCDOUT?C	080h
	LCDOUTD?W	_TIEMPO3
	LCDOUT?C	06Dh
	LCDOUT?C	053h
	PAUSEUS?C	02706h
	ADD?WCW	_tiempo, 001h, _tiempo
	CMPGE?WCL	_tiempo, 064h, L00001
	GOTO?L	_cronometro
	LABEL?L	L00001	
	MOVE?CW	000h, _tiempo
	ADD?WCW	_TIEMPO2, 001h, _TIEMPO2
	GOTO?L	_cronometro

	LABEL?L	_mostrar1	
	SUB?WCW	_TIEMPO3, 001h, _TIEMPO3

	LABEL?L	_mostrar11	
	HIGH?T	_PANTALLA1
	LOW?T	_PANTALLA2
	LCDOUT?C	0FEh
	LCDOUT?C	080h
	LCDOUTD?W	_TIEMPO3
	LCDOUT?C	0FEh
	LCDOUT?C	0C0h
	LCDOUT?C	048h
	LCDOUT?C	041h
	LCDOUT?C	020h
	LCDOUT?C	044h
	LCDOUT?C	049h
	LCDOUT?C	053h
	LCDOUT?C	050h
	LCDOUT?C	041h
	LCDOUT?C	052h
	LCDOUT?C	041h
	LCDOUT?C	044h
	LCDOUT?C	04Fh
	LCDOUT?C	0FEh
	LCDOUT?C	094h
	LCDOUT?C	046h
	LCDOUT?C	055h
	LCDOUT?C	053h
	LCDOUT?C	049h
	LCDOUT?C	042h
	LCDOUT?C	04Ch
	LCDOUT?C	045h
	LCDOUT?C	020h
	LCDOUT?C	031h
	CMPEQ?TCL	_FUSIBLE1, 000h, _inicio
	GOTO?L	_mostrar11

	LABEL?L	_mostrar2	
	SUB?WCW	_TIEMPO3, 001h, _TIEMPO3

	LABEL?L	_mostrar22	
	HIGH?T	_PANTALLA2
	LOW?T	_PANTALLA1
	LCDOUT?C	0FEh
	LCDOUT?C	080h
	LCDOUTD?W	_TIEMPO3
	LCDOUT?C	0FEh
	LCDOUT?C	0C0h
	LCDOUT?C	048h
	LCDOUT?C	041h
	LCDOUT?C	020h
	LCDOUT?C	044h
	LCDOUT?C	049h
	LCDOUT?C	053h
	LCDOUT?C	050h
	LCDOUT?C	041h
	LCDOUT?C	052h
	LCDOUT?C	041h
	LCDOUT?C	044h
	LCDOUT?C	04Fh
	LCDOUT?C	0FEh
	LCDOUT?C	094h
	LCDOUT?C	046h
	LCDOUT?C	055h
	LCDOUT?C	053h
	LCDOUT?C	049h
	LCDOUT?C	042h
	LCDOUT?C	04Ch
	LCDOUT?C	045h
	LCDOUT?C	020h
	LCDOUT?C	032h
	CMPEQ?TCL	_FUSIBLE2, 000h, _inicio
	GOTO?L	_mostrar22
	END?	

	END
